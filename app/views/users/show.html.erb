<div class="full_page">
  <h1><%= @user.name.upcase %></h1>
  <% if @user.has_role?(:writer) %>
    <h2>SCRITTORE</h2>
    <div class="bio_section">
      <p class="profile_label">INFORMAZIONI PERSONALI</p>
      <% if @user.bio.empty? %>
        <p style="font-size: 1.3em;">Non ha ancora inserito le sue informazioni!</p>
        <% if current_user == @user %>
          <%= link_to 'Modifica account', edit_user_registration_path, class: "btn btn-primary" %>
        <% end %>
      <% else %>
        <p style="font-size: 1.3em; padding-top: 20px;"><%= @user.bio %></p>
      <% end %>
    </div>
    <div class="written_books">
      <p class="profile_label">LIBRI DI CUI Ãˆ AUTORE</p>
      <% if @user.written_books.length > 0 %>
        <table>
          <thead>
            <tr>
              <th>Titolo</th>
              <th>Genere</th>
              <th>Trama</th>
              <th>Anno di pubblicazione</th>
              <th colspan="3"></th>
            </tr>
          </thead>
          <tbody>
            <% @user.written_books.each do |book| %>
              <tr>
                <td><%= book.title %></td>
                <td><%= book.genre %></td>
                <td><%= truncate(book.plot, length: 300) %></td>
                <td><%= book.year %></td>
                <td><%= link_to 'Mostra', book, id: "book_button" %></td>
                <% if current_user == book.writer %>
                  <td><%= link_to 'Modifica', edit_book_path(book), id: "book_button" %></td>
                  <td><%= link_to 'Elimina', book, method: :delete, data: { confirm: 'Sei sicuro?' }, id: "book_button" %></td>
                <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p style="font-size: 1.3em;">Non ha ancora pubblicato libri!</p>
      <% end %>
    </div>
  <% elsif @user.has_role?(:publisher) %>
    <h2>CASA EDITRICE</h2>
    <div class="head_office_section">
      <p class="profile_label">SEDE</p>
      <% if @user.head_office.empty? %>
        <p style="font-size: 1.3em;">Non ha ancora inserito la sua sede!</p>
        <% if current_user == @user %>
          <%= link_to 'Modifica account', edit_user_registration_path, class: "btn btn-primary" %>
        <% end %>
      <% else %>
        <p style="font-size: 1.3em; padding-top: 20px;"><%= @user.head_office %></p>
      <% end %>
    </div>
  <% end %>
  <% if !@user.has_role?(:publisher) %>
    <div class="preferred_books">
      <p class="profile_label">LIBRI PREFERITI</p>
      <% if @user.books.length > 0 %>
        <table>
          <thead>
            <tr>
              <th>Titolo</th>
              <th>Autore</th>
              <th>Genere</th>
              <th>Trama</th>
              <th>Anno di pubblicazione</th>
              <th colspan="3"></th>
            </tr>
          </thead>
          <tbody>
            <% @user.books.each do |book| %>
              <tr>
                <td><%= book.title %></td>
                <td><%= book.writer.name %></td>
                <td><%= book.genre %></td>
                <td><%= truncate(book.plot, length: 300) %></td>
                <td><%= book.year %></td>
                <td><%= link_to 'Mostra', book, id: "book_button" %></td>
                <% if current_user == book.writer %>
                  <td><%= link_to 'Modifica', edit_book_path(book), id: "book_button" %></td>
                  <td><%= link_to 'Elimina', book, method: :delete, data: { confirm: 'Sei sicuro?' }, id: "book_button" %></td>
                <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p style="font-size: 1.3em;">Non ha ancora scelto i suoi libri preferiti!</p>
      <% end %>
    </div>
  <% end %>
</div>
